<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DripGear — Produse</title>
  <style>
    :root{
      --bg:#000000;
      --card:#0a0f18;
      --muted:#9aa4b2;
      --accent:#00cfff;
      --text:#ffffff;
    }
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--text);margin:0;padding:32px}
    .wrap{max-width:1200px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px}
    header h1{margin:0;font-size:22px;color:var(--text)}
    header img{height:50px;margin-right:12px}
    .logo-wrap{display:flex;align-items:center;gap:10px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(2,6,23,.6);display:flex;flex-direction:column;color:var(--text)}
    .thumb{height:200px;border-radius:8px;background:#0a0f18;background-size:cover;background-position:center;margin-bottom:12px}
    .title{font-weight:600;margin:0 0 6px 0;color:var(--text)}
    .desc{color:var(--muted);font-size:13px;margin:0 0 10px 0;min-height:36px}
    .meta{display:flex;justify-content:space-between;align-items:center}
    .price{font-weight:700;color:var(--accent)}
    .btn{background:transparent;border:1px solid var(--accent);padding:8px 10px;border-radius:8px;color:var(--text);cursor:pointer}
    .btn.primary{background:var(--accent);color:#000;border:none}
    .controls{display:flex;gap:8px}
    .small{font-size:12px;padding:6px 8px;border-radius:8px}

    /* editor modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.7)}
    .modal.open{display:flex}
    .panel{background:#0a0f18;padding:20px;border-radius:12px;min-width:320px;max-width:760px;color:var(--text)}
    label{display:block;font-size:13px;margin-top:10px;color:var(--muted)}
    input[type=text],textarea{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,.12);background:#000;color:var(--text)}
    textarea{min-height:90px}
    .row{display:flex;gap:10px}
    .row > *{flex:1}
    footer{margin-top:18px;display:flex;gap:10px;justify-content:flex-end}

    /* responsive */
    @media (max-width:520px){.thumb{height:160px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo-wrap">
        <img src="03e3f1e2-bb2b-45c4-b9ff-3211e757fa91.png" alt="DripGear Logo">
        <h1>DripGear — Catalog produse</h1>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <button id="importBtn" class="btn small">Import JSON</button>
        <button id="exportBtn" class="btn small">Export JSON</button>
        <button id="addBtn" class="btn primary small">Adaugă produs</button>
      </div>
    </header>

    <main>
      <section class="grid" id="productsGrid" aria-live="polite"></section>
    </main>

    <div id="editor" class="modal" role="dialog" aria-modal="true">
      <div class="panel">
        <h2 id="editorTitle">Editare produs</h2>
        <input type="file" id="imageInput" accept="image/*" />
        <label>Nume produs</label>
        <input id="pName" type="text" />
        <label>Preț</label>
        <input id="pPrice" type="text" />
        <label>Descriere</label>
        <textarea id="pDesc"></textarea>
        <label>Previzualizare imagine</label>
        <div id="preview" style="height:160px;border-radius:8px;background:#0b1220;background-size:cover;background-position:center"></div>
        <footer>
          <button id="saveBtn" class="btn primary">Salvează</button>
          <button id="cancelBtn" class="btn">Anulează</button>
          <button id="deleteBtn" class="btn" style="margin-left:auto;background:transparent;color:#ff8a8a;border:1px solid rgba(255,138,138,.12)">Șterge produs</button>
        </footer>
      </div>
    </div>

    <input id="fileImport" type="file" accept="application/json" style="display:none" />
  </div>

  <script>
    // ===== Simple local editable product grid
    function generateId(){return 'p_'+Math.random().toString(36).slice(2,9)}
    const defaultProducts = [
      {id:generateId(),name:'Drip Tee - Black',price:'49.99',desc:'Tricou premium cu print unic.',img:''},
      {id:generateId(),name:'Drip Hoodie - Olive',price:'69.99',desc:'Hanorac gros, brodat DripGear.',img:''},
      {id:generateId(),name:'Drip Cap',price:'24.99',desc:'Șapcă ajustabilă cu logo.',img:''}
    ];

    const STORAGE_KEY = 'dripgear_products_v1';
    let products = loadProducts();
    const grid = document.getElementById('productsGrid');

    function loadProducts(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(raw) return JSON.parse(raw);
      }catch(e){}
      return defaultProducts;
    }
    function saveProducts(){localStorage.setItem(STORAGE_KEY,JSON.stringify(products));}

    function render(){
      grid.innerHTML='';
      products.forEach(p=>{
        const el = document.createElement('article');
        el.className='card';
        const imgStyle = p.img?`background-image:url(${p.img})`:'background:#000';
        el.innerHTML = `
          <div class="thumb" style="${imgStyle}"></div>
          <h3 class="title">${escapeHtml(p.name)}</h3>
          <p class="desc">${escapeHtml(p.desc)}</p>
          <div class="meta">
            <div class="price">${escapeHtml(p.price)} €</div>
            <div class="controls">
              <button class="btn" data-action="edit" data-id="${p.id}">Editează</button>
              <button class="btn" data-action="clone" data-id="${p.id}">Clonează</button>
            </div>
          </div>
        `;
        grid.appendChild(el);
      });
    }

    function escapeHtml(s){return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

    // Editor logic
    const editor = document.getElementById('editor');
    const imageInput = document.getElementById('imageInput');
    const preview = document.getElementById('preview');
    const pName = document.getElementById('pName');
    const pPrice = document.getElementById('pPrice');
    const pDesc = document.getElementById('pDesc');
    const saveBtn = document.getElementById('saveBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const deleteBtn = document.getElementById('deleteBtn');
    const addBtn = document.getElementById('addBtn');
    const importBtn = document.getElementById('importBtn');
    const exportBtn = document.getElementById('exportBtn');
    const fileImport = document.getElementById('fileImport');

    let editingId = null;

    grid.addEventListener('click', e=>{
      const btn = e.target.closest('button');
      if(!btn) return;
      const action = btn.dataset.action;
      const id = btn.dataset.id;
      if(action==='edit') openEditor(id);
      if(action==='clone') {
        const src = products.find(x=>x.id===id);
        if(src){
          const clone = {...src,id:generateId(),name:src.name+' (copy)'};
          products.unshift(clone);saveProducts();render();
        }
      }
    });

    addBtn.addEventListener('click',()=>{
      const newP = {id:generateId(),name:'Produs nou',price:'0.00',desc:'Descriere...',img:''};
      products.unshift(newP);saveProducts();render();openEditor(newP.id);
    });

    function openEditor(id){
      editingId = id;
      const p = products.find(x=>x.id===id);
      if(!p) return;
      pName.value = p.name; pPrice.value = p.price; pDesc.value = p.desc;
      preview.style.backgroundImage = p.img?`url(${p.img})`:'none';
      editor.classList.add('open');
    }

    cancelBtn.addEventListener('click',()=>{editor.classList.remove('open');editingId=null});

    imageInput.addEventListener('change', async (ev)=>{
      const f = ev.target.files && ev.target.files[0];
      if(!f) return;
      const data = await fileToDataUrl(f);
      preview.style.backgroundImage = `url(${data})`;
      const p = products.find(x=>x.id===editingId);
      if(p){p.img=data}
    });

    saveBtn.addEventListener('click',()=>{
      const p = products.find(x=>x.id===editingId);
      if(!p) return;
      p.name = pName.value; p.price = pPrice.value; p.desc = pDesc.value;
      saveProducts(); render(); editor.classList.remove('open'); editingId=null;
    });

    deleteBtn.addEventListener('click',()=>{
      if(!confirm('Ștergi acest produs?')) return;
      products = products.filter(x=>x.id!==editingId); saveProducts(); render(); editor.classList.remove('open'); editingId=null;
    });

    // Export / import
    exportBtn.addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(products, null, 2)],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='dripgear_products.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    importBtn.addEventListener('click', ()=>fileImport.click());
    fileImport.addEventListener('change', async (e)=>{
      const f = e.target.files[0]; if(!f) return;
      try{
        const txt = await f.text();
        const imported = JSON.parse(txt);
        if(Array.isArray(imported)){
          products = imported.map(it=>({id:it.id||generateId(),name:it.name||'',price:it.price||'',desc:it.desc||'',img:it.img||''}));
          saveProducts(); render(); alert('Import OK');
        }else alert('JSON invalid (trebuie o listă de produse)');
      }catch(err){alert('Eroare la import: '+err.message)}
    });

    function fileToDataUrl(file){
      return new Promise((res,rej)=>{
        const r = new FileReader(); r.onload = ()=>res(r.result); r.onerror=rej; r.readAsDataURL(file);
      })
    }

    (function ensureImages(){
      let dirty=false;
      products.forEach((p,i)=>{ if(!p.img){ p.img = placeholder(i); dirty=true } });
      if(dirty) saveProducts();
    })();

    function placeholder(i){
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'><rect width='100%' height='100%' fill='#000'/><text x='50%' y='50%' fill='#00cfff' font-size='32' font-family='Arial' dominant-baseline='middle' text-anchor='middle'>DripGear</text></svg>`;
      return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
    }

    render();
  </script>
</body>
</html>
